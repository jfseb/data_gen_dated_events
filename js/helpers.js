"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.genPerson = exports.isHireChange = exports.writeRecord = exports.memorizeSOM = exports.toDec1 = exports.writeTripel = exports.writeAge = exports.getSOM = exports.writeTenure = exports.writeTENUREAGE = exports.diffMonth = exports.diffYears = exports.writeDay = exports.writeHeader = exports.daysInMonth = exports.EOMONTH = exports.asDate = exports.padSpaceQ = exports.padSpace = exports.pad = exports.isEOY = exports.isEOQ = exports.copyDate = exports.dateIndexToDate = exports.Person = exports.GenParams = exports.makeMap = exports.dateToDayIndex = exports.EXCELOFFSET = void 0;
var fs = require('fs');
const { exit } = require('process');
// EXCEL
//     1 1900-01-01
// 25569 1970-01-01
//
exports.EXCELOFFSET = 25569;
const core_1 = require("@js-joda/core");
function dateToDayIndex(d) {
    return d.toEpochDay() + exports.EXCELOFFSET;
}
exports.dateToDayIndex = dateToDayIndex;
var d1 = core_1.LocalDate.of(2020, 1, 6);
var d1Idx = dateToDayIndex(d1);
var d2 = core_1.LocalDate.of(2024, 6, 1);
var d2Idx = dateToDayIndex(d2);
var deltaTime = d2Idx - d1Idx;
function makeMap(obj) {
    var idx = 0;
    var res = [];
    Object.getOwnPropertyNames(obj).forEach(function (a) {
        for (var i = 0; i < obj[a]; ++i) {
            res.push(a);
        }
    });
    return res;
}
exports.makeMap = makeMap;
//console.log(locations);
//console.log(locations.length);
class GenParams {
}
exports.GenParams = GenParams;
class Person {
}
exports.Person = Person;
function getNext(pars) {
    return Math.floor(pars.random() * pars.AVG_NEXT) + 1;
}
function getLocation(pars) {
    return pars.locations[Math.floor(pars.random() * pars.locations.length)];
}
function nextLocation(pars, pers) {
    if (pars.random() < pars.LOCCHANGE) {
        return getLocation(pars);
    }
    return pers.location;
}
function nextFTE(pars, pers) {
    if (pars.random() < pars.FTECHANGE) {
        if (pers.fte == 1) {
            return 0.5;
        }
        return 1.0;
    }
    return pers.fte;
}
function isEvent(pars) {
    return pars.random() < pars.L_EVENT;
}
function dateIndexToDate(dateIdx) {
    return core_1.LocalDate.ofEpochDay(dateIdx - exports.EXCELOFFSET);
}
exports.dateIndexToDate = dateIndexToDate;
function isEOM(dateIdx) {
    var d = undefined;
    if (dateIdx instanceof core_1.LocalDate) {
        d = dateIdx;
    }
    else {
        d = dateIndexToDate(dateIdx);
    }
    var d = copyDate(d).plusDays(1);
    if (d.dayOfMonth() == 1)
        return true;
    return false;
}
function copyDate(d) {
    return core_1.LocalDate.ofEpochDay(d.toEpochDay());
}
exports.copyDate = copyDate;
function isEOQ(d) {
    d = copyDate(d).plusDays(1);
    if (d.dayOfMonth() == 1 && [1, 4, 7, 10].indexOf(d.monthValue()) >= 0)
        return true;
    return false;
}
exports.isEOQ = isEOQ;
function isEOY(d) {
    var d = copyDate(d).plusDays(1);
    if (d.dayOfMonth() == 1 && d.monthValue() == 1)
        return true;
    return false;
}
exports.isEOY = isEOY;
function pad(a, len) {
    var s = "" + a;
    return "0000000".substr(0, len - s.length) + s;
}
exports.pad = pad;
function padSpace(a, len) {
    var s = "" + a;
    return "                   ".substr(0, len - s.length) + s;
}
exports.padSpace = padSpace;
function padSpaceQ(a, len) {
    var s = "" + a;
    return '"' + s + '"' + "                   ".substr(0, len - s.length);
}
exports.padSpaceQ = padSpaceQ;
function asDate(dateIdx) {
    var d = undefined;
    if (dateIdx instanceof core_1.LocalDate) {
        d = dateIdx;
    }
    else {
        d = dateIndexToDate(dateIdx);
    }
    return '' + d;
    //return d.year() + "-" + pad(d.monthValue(),2) + "-" + pad(d.dayOfMonth(),2);
}
exports.asDate = asDate;
function EOMONTH(d) {
    return copyDate(d).plusMonths(1).withDayOfMonth(1).minusDays(1);
}
exports.EOMONTH = EOMONTH;
function daysInMonth(d) {
    var dt = undefined;
    if (d instanceof core_1.LocalDate) {
        dt = d;
    }
    else {
        dt = dateIndexToDate(d);
    }
    var deom = EOMONTH(dt);
    return dateToDayIndex(deom) - dateToDayIndex(copyDate(deom).withDayOfMonth(1)) + 1;
}
exports.daysInMonth = daysInMonth;
function writeHeader(ws) {
    ws.write("CALMONTHIC;CALMONTHI;CALMONTH;CALMONTHS;START_DATE_IDX;END_DATE_IDX;ISEOM;ISEOQ;ISEOY;DAYSINMONTH;START_DATE;END_DATE;");
    ws.write("USER;LOCATION;HC;HC_SOM;HC_EOM;DAYSWORKED;FTE;FTE_SOM;FTE_EOM;FTEWORKED;TENURE;TENURE_SOM;TENURE_EOM;AGE;AGE_SOM;AGE_EOM;X\n");
}
exports.writeHeader = writeHeader;
function writeDay(ws, prevDateEnd, dateIdx) {
    var startIdx = copyDate(prevDateEnd).plusDays(1);
    var d = dateIdx;
    var y = d.year();
    var m = d.monthValue();
    var cmi = y * 100 + m;
    var cmic = (y - 2000) * 12 + m;
    ws.write('' + cmic + ";" + cmi + ";" + cmi + ";" + cmi + ";"); // CALMONTH IC I ~ S
    ws.write(dateToDayIndex(startIdx) + ";" + dateToDayIndex(dateIdx) + ";");
    ws.write(isEOM(d) ? "1.0" : "0.0").write(";");
    ws.write(isEOQ(d) ? "1.0" : "0.0").write(";");
    ws.write(isEOY(d) ? "1.0" : "0.0").write(";");
    var dim = daysInMonth(d);
    ws.write(dim).write(";");
    ws.write(asDate(startIdx)).write(";");
    ws.write(asDate(d)).write(";");
    return dim;
}
exports.writeDay = writeDay;
function diffYears(dateLow, dateHigh) {
    return dateLow.until(dateHigh).years();
}
exports.diffYears = diffYears;
function diffMonth(dateLow, dateHigh) {
    var a = dateLow.until(dateHigh);
    return a.years() * 12 + a.months();
}
exports.diffMonth = diffMonth;
function writeTENUREAGE(pers) {
    return pers.hired > 0;
}
exports.writeTENUREAGE = writeTENUREAGE;
//console.log(diffYears(new Date(2001,2,1), new Date(2002,3,1)));
//console.log(diffYears(new Date(2001,2,1), new Date(2003,1,31)));
//console.log(diffYears(new Date(2001,2,1), new Date(2003,2,1)));
function writeTenure(ws, now, pers, eom) {
    if (!writeTENUREAGE(pers)) {
        ws.write('0;0;0;');
        return;
    }
    var tenureNow = diffMonth(pers.lastHired, now);
    ws.write(tenureNow).write(';');
    if (isEOM(now)) {
        var dsom = getSOM(now);
        var tenureSOM = diffMonth(pers.lastHired, dsom);
        ws.write(tenureSOM).write(';');
        ws.write(tenureNow).write(';');
    }
    else {
        ws.write('0;0;');
    }
}
exports.writeTenure = writeTenure;
function getSOM(dateIdx) {
    return dateIdx.withDayOfMonth(1);
}
exports.getSOM = getSOM;
function writeAge(ws, now, pers, eom) {
    if (!writeTENUREAGE(pers)) {
        ws.write('0;0;0;');
        return;
    }
    var ageNow = diffYears(pers.dob, now);
    ws.write(ageNow).write(';');
    if (isEOM(now)) {
        var dsom = getSOM(now);
        var ageSOM = diffYears(pers.dob, dsom);
        ws.write(ageSOM).write(';');
        ws.write(ageNow).write(';');
    }
    else {
        ws.write('0;0;');
    }
}
exports.writeAge = writeAge;
function writeTripel(ws, vsom, vnow, eom) {
    ws.write(padSpace(vnow, 3)).write(';');
    if (eom) {
        ws.write(padSpace(vsom, 3)).write(';');
        ws.write(padSpace(vnow, 3)).write(';');
    }
    else {
        ws.write('0.0;0.0;');
    }
}
exports.writeTripel = writeTripel;
function toDec1(n) {
    return (n || 0).toFixed(1);
}
exports.toDec1 = toDec1;
function memorizeSOM(eom, pers) {
    if (eom) {
        pers.fteSOM = pers.hired * pers.fte;
        pers.hiredSOM = pers.hired;
    }
}
exports.memorizeSOM = memorizeSOM;
function writeRecord(ws, dateIdx, pers, comment) {
    var startIdx = copyDate(pers.prevDateEnd).plusDays(1);
    var eom = isEOM(dateIdx);
    ws.write(padSpaceQ(pers.user, 5)).write(';');
    ws.write(padSpaceQ(pers.location, 20)).write(';');
    writeTripel(ws, pers.hiredSOM ? "1.0" : "0.0", pers.hired ? "1.0" : "0.0", isEOM(dateIdx));
    var daysInPeriod = startIdx.until(dateIdx).days() + 1;
    ws.write(padSpace(pers.hiredPrev * daysInPeriod, 2)).write(';'); //DAYSWORKED
    writeTripel(ws, toDec1(pers.fteSOM), toDec1(pers.hired * pers.fte), isEOM(dateIdx));
    ws.write(padSpace(pers.hiredPrev * pers.ftePrev * daysInPeriod, 4)).write(';'); // FTEWORKED
    writeTenure(ws, dateIdx, pers, eom);
    writeAge(ws, dateIdx, pers, eom);
    pers.hiredPrev = pers.hired;
    pers.ftePrev = pers.fte;
    memorizeSOM(eom, pers);
    pers.prevDateEnd = dateIdx;
    ws.write(comment + "\n");
}
exports.writeRecord = writeRecord;
function writeStateLine(ws, dateIdx, pers, nextHire, nextLoc, nextFTE, comment) {
    writeDay(ws, pers.prevDateEnd, dateIdx);
    pers.location = nextLoc || pers.location;
    pers.fte = nextFTE || pers.fte;
    pers.lastWritten = dateIdx;
    writeRecord(ws, dateIdx, pers, "st" + comment);
    if (nextHire != pers.hired) {
        ws.write("NEVER\n");
    }
}
function isUnhiredChange(pers, nextHire, nextLoc, nextFTE) {
    return (nextHire != pers.hired)
        || (nextLoc != pers.location)
        || (nextFTE != pers.fte);
}
function isAChange(pers, nextHire, nextLoc, nextFTE) {
    return (nextHire != pers.hired)
        || (pers.hired && nextLoc != pers.location)
        || (pers.hired && nextFTE != pers.fte);
}
function isHIRE(pers, nextHire) {
    return pers.hired == 0 && nextHire == 1;
}
function isTERM(pers, nextHire) {
    return pers.hired == 1 && nextHire == 0;
}
// there is a change @date , new values are to the right;
function writeChangeLine(ws, dateIdx, pers, nextHire, nextLoc, nextFTE, comment) {
    var isChange = isAChange(pers, nextHire, nextLoc, nextFTE);
    if (!isChange && !isEOM(dateIdx)) {
        pers.location = nextLoc;
        pers.nextFTE = nextFTE;
        return;
    }
    var isterm = isTERM(pers, nextHire);
    if (isterm) {
        // close previous record
        if (dateIdx.dayOfMonth() != 1) { // unless we already closed it by a month record
            var dmin1 = copyDate(dateIdx).minusDays(1);
            writeDay(ws, pers.prevDateEnd, dmin1);
            writeRecord(ws, dmin1, pers, "termclose-1" + dateIdx + ' ' + comment);
        }
        pers.hired = 0;
        pers.hiredPrev = 0;
        pers.lastTerm = dateIdx;
    }
    else if (isHIRE(pers, nextHire)) {
        pers.lastHired = dateIdx;
        pers.prevDateEnd = copyDate(dateIdx).minusDays(1);
        // do nothing, will be captured next
    }
    else {
        // close previous record
        if (dateIdx.dayOfMonth() != 1) {
            // unless we already closed it by a month record
            var dmin1 = copyDate(dateIdx).minusDays(1);
            writeDay(ws, pers.prevDateEnd, dmin1);
            writeRecord(ws, dmin1, pers, "perclose-1 from " + dateIdx + ' ' + comment);
        }
    }
    pers.hired = nextHire;
    pers.location = nextLoc;
    pers.fte = nextFTE;
    if (isEOM(dateIdx)) {
        // later suppress unles lastTerm within range
        writeStateLine(ws, dateIdx, pers, pers.hired, pers.location, pers.fte, "WCL");
    }
}
/////////////////// percentages
function isHireChange(pars) {
    return pars.random() < pars.L_HIRE;
}
exports.isHireChange = isHireChange;
function genPerson(ws, p, pars) {
    var pers = {
        user: p,
        hired: 0,
        hiredPrev: 0,
        fte: 1,
        ftePrev: 0,
        dob: core_1.LocalDate.of(1950 + Math.floor(pars.random() * 55), Math.floor(pars.random() * 12), Math.floor(pars.random() * 31)),
        location: getLocation(pars),
        prevDateEnd: pars.firstDate,
        hiredSOM: 0,
        lastHired: pars.firstDate,
        lastRecorded: pars.firstDate,
        fteSOM: 0
    };
    var nextDate = getNext(pars) + pars.firstDate.toEpochDay();
    for (var i = pars.firstDate.toEpochDay(); i <= pars.lastDate.toEpochDay(); ++i) {
        var d = core_1.LocalDate.ofEpochDay(i);
        if (i == nextDate) {
            if (isHireChange(pars)) {
                writeChangeLine(ws, d, pers, pers.hired ? 0 : 1, nextLocation(pars, pers), nextFTE(pars, pers), "HC");
                nextDate += getNext(pars);
            }
            else if (isEvent(pars)) {
                var nl = nextLocation(pars, pers);
                // force
                var nf = nextFTE(pars, pers);
                while (!isUnhiredChange(pers, pers.hired, nl, nf)) {
                    nl = nextLocation(pars, pers);
                    // force
                    nf = nextFTE(pars, pers);
                }
                writeChangeLine(ws, d, pers, pers.hired, nl, nf, "LC");
                nextDate += getNext(pars);
            }
            else if (isEOM(d)) {
                writeStateLine(ws, d, pers, pers.hired, pers.location, pers.fte, "EOMe");
            }
        }
        else if (isEOM(d)) {
            //if( pers.hired > 0 ) {
            writeStateLine(ws, d, pers, pers.hired, pers.location, pers.fte, "EOM");
            //}
            // lese {
            memorizeSOM(true, pers);
            //}
        }
    }
    ;
}
exports.genPerson = genPerson;

//# sourceMappingURL=data:application/json;charset=utf8;base64,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USxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDMUUsR0FBRztZQUNILFNBQVM7WUFDUCxXQUFXLENBQUMsSUFBSSxFQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3pCLEdBQUc7U0FDSjtLQUNIO0lBQUEsQ0FBQztBQUNILENBQUM7QUE3Q0QsOEJBNkNDIiwiZmlsZSI6ImhlbHBlcnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZnMgPSByZXF1aXJlKCdmcycpO1xyXG5jb25zdCB7IGV4aXQgfSA9IHJlcXVpcmUoJ3Byb2Nlc3MnKTtcclxuXHJcbi8vdmFyIHNlZWRyYW5kb20gPSByZXF1aXJlKCdzZWVkcmFuZG9tJyk7XHJcbmltcG9ydCAqIGFzIHNlZWRyYW5kb20gZnJvbSAnc2VlZHJhbmRvbSc7XHJcbi8vIEVYQ0VMXHJcbi8vICAgICAxIDE5MDAtMDEtMDFcclxuLy8gMjU1NjkgMTk3MC0wMS0wMVxyXG4vL1xyXG5leHBvcnQgY29uc3QgRVhDRUxPRkZTRVQgPSAyNTU2OTtcclxuXHJcbmltcG9ydCB7TG9jYWxEYXRlIH0gZnJvbSAgXCJAanMtam9kYS9jb3JlXCI7XHJcbmltcG9ydCB7IFNTTF9PUF9ET05UX0lOU0VSVF9FTVBUWV9GUkFHTUVOVFMgfSBmcm9tICdjb25zdGFudHMnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRhdGVUb0RheUluZGV4KGQgOiBMb2NhbERhdGUgKSA6IG51bWJlciB7XHJcbiAgcmV0dXJuICBkLnRvRXBvY2hEYXkoKSArIEVYQ0VMT0ZGU0VUO1xyXG59XHJcblxyXG52YXIgZDEgPSBMb2NhbERhdGUub2YoMjAyMCwxLDYpO1xyXG52YXIgZDFJZHggPSBkYXRlVG9EYXlJbmRleChkMSk7XHJcbnZhciBkMiA9IExvY2FsRGF0ZS5vZigyMDI0LDYsMSk7XHJcbnZhciBkMklkeCA9IGRhdGVUb0RheUluZGV4KGQyKTtcclxudmFyIGRlbHRhVGltZSA9IGQySWR4LWQxSWR4O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VNYXAob2JqKSB7XHJcbiAgdmFyIGlkeCA9IDA7XHJcbiAgdmFyIHJlcyA9IFtdO1xyXG4gIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9iaikuZm9yRWFjaCggZnVuY3Rpb24oYSkge1xyXG4gICAgZm9yKHZhciBpID0gMDsgaSA8IG9ialthXTsgKytpKSB7XHJcbiAgICAgIHJlcy5wdXNoKGEpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gIHJldHVybiByZXM7XHJcbn1cclxuXHJcbi8vY29uc29sZS5sb2cobG9jYXRpb25zKTtcclxuLy9jb25zb2xlLmxvZyhsb2NhdGlvbnMubGVuZ3RoKTtcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgR2VuUGFyYW1zIHtcclxuICBBVkdfTkVYVCA6IG51bWJlcjtcclxuICBMT0NDSEFOR0UgOiBudW1iZXI7XHJcbiAgRlRFQ0hBTkdFOiBudW1iZXI7XHJcbiAgTF9ISVJFIDogbnVtYmVyO1xyXG4gIExfRVZFTlQgOiBudW1iZXI7XHJcbiAgbG9jYXRpb25zOiBzdHJpbmdbXTtcclxuICBmaXJzdERhdGUgOiBMb2NhbERhdGU7XHJcbiAgbGFzdERhdGUgOiBMb2NhbERhdGU7XHJcbiAgcmFuZG9tIDogYW55O1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIFBlcnNvbiB7XHJcbiAgLy8gaW1tdXRhYmxlXHJcbiAgdXNlcjogc3RyaW5nO1xyXG4gIC8vIGNoYW5naW5nXHJcbiAgZG9iOiBMb2NhbERhdGU7XHJcbiAgbG9jYXRpb24gOiBzdHJpbmc7XHJcbiAgaGlyZWQ6IG51bWJlcjtcclxuICBoaXJlZFNPTTogbnVtYmVyO1xyXG4gIGhpcmVkUHJldiA6IG51bWJlcjsgLy8gcGVyc29uICBoaXJlIHN0YXRlIHByZXZpb3VzIHJhbmdlXHJcbiAgZnRlIDogbnVtYmVyO1xyXG4gIGZ0ZVByZXYgOiBudW1iZXI7IC8vIHBlcnNvbiBmdGUgc3RhdGUgcHJldmlvdXMgcmFuZ2VcclxuICBmdGVTT006IG51bWJlcjtcclxuICAvLyBjaGFuZ2luZ1xyXG4gIGxhc3RIaXJlZDogTG9jYWxEYXRlO1xyXG4gIGxhc3RSZWNvcmRlZDogTG9jYWxEYXRlO1xyXG4gIHByZXZEYXRlRW5kIDogTG9jYWxEYXRlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXROZXh0KHBhcnM6R2VuUGFyYW1zKSB7XHJcbiAgcmV0dXJuIE1hdGguZmxvb3IocGFycy5yYW5kb20oKSAqIHBhcnMuQVZHX05FWFQpICsgMTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0TG9jYXRpb24ocGFyczogR2VuUGFyYW1zKSB7XHJcbiAgcmV0dXJuIHBhcnMubG9jYXRpb25zW01hdGguZmxvb3IocGFycy5yYW5kb20oKSAqIHBhcnMubG9jYXRpb25zLmxlbmd0aCldO1xyXG59XHJcblxyXG5mdW5jdGlvbiBuZXh0TG9jYXRpb24ocGFyczogR2VuUGFyYW1zLCBwZXJzIDogUGVyc29uKSB7XHJcbiAgaWYoIHBhcnMucmFuZG9tKCkgPCBwYXJzLkxPQ0NIQU5HRSkge1xyXG4gICAgcmV0dXJuIGdldExvY2F0aW9uKHBhcnMpO1xyXG4gIH1cclxuICByZXR1cm4gIHBlcnMubG9jYXRpb247XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5leHRGVEUocGFyczogR2VuUGFyYW1zLCBwZXJzIDogUGVyc29uKSB7XHJcbiAgaWYoIHBhcnMucmFuZG9tKCkgPCBwYXJzLkZURUNIQU5HRSkge1xyXG4gICAgaWYoIHBlcnMuZnRlID09IDEpIHtcclxuICAgICAgcmV0dXJuIDAuNTtcclxuICAgIH1cclxuICAgIHJldHVybiAxLjA7XHJcbiAgfVxyXG4gIHJldHVybiBwZXJzLmZ0ZTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGlzRXZlbnQocGFyczpHZW5QYXJhbXMpIHtcclxuICByZXR1cm4gcGFycy5yYW5kb20oKSA8IHBhcnMuTF9FVkVOVDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRhdGVJbmRleFRvRGF0ZShkYXRlSWR4IDogbnVtYmVyKSA6IExvY2FsRGF0ZSB7XHJcbiAgcmV0dXJuIExvY2FsRGF0ZS5vZkVwb2NoRGF5KGRhdGVJZHggLSBFWENFTE9GRlNFVCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzRU9NKGRhdGVJZHggOiBhbnkpIHtcclxuICB2YXIgZCA9IHVuZGVmaW5lZCBhcyBMb2NhbERhdGU7XHJcbiAgaWYgKCBkYXRlSWR4IGluc3RhbmNlb2YgTG9jYWxEYXRlKSB7XHJcbiAgICBkID0gZGF0ZUlkeDtcclxuICB9XHJcbiAgZWxzZSB7XHJcbiAgICAgZCA9IGRhdGVJbmRleFRvRGF0ZShkYXRlSWR4KTtcclxuICB9XHJcbiAgdmFyIGQgPSBjb3B5RGF0ZShkKS5wbHVzRGF5cygxKTtcclxuICBpZihkLmRheU9mTW9udGgoKSA9PSAxKVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgcmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29weURhdGUoZCA6IExvY2FsRGF0ZSkge1xyXG4gIHJldHVybiBMb2NhbERhdGUub2ZFcG9jaERheShkLnRvRXBvY2hEYXkoKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0VPUShkOiBMb2NhbERhdGUpIHtcclxuICBkID0gY29weURhdGUoZCkucGx1c0RheXMoMSk7XHJcbiAgaWYoZC5kYXlPZk1vbnRoKCkgPT0gMSAmJiAgWzEsNCw3LDEwXS5pbmRleE9mKGQubW9udGhWYWx1ZSgpKSA+PSAwKVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgcmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0VPWShkIDogTG9jYWxEYXRlKSB7XHJcbiAgdmFyIGQgPSBjb3B5RGF0ZShkKS5wbHVzRGF5cygxKTtcclxuICBpZihkLmRheU9mTW9udGgoKSA9PSAxICYmIGQubW9udGhWYWx1ZSgpID09IDEpXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwYWQoYSA6IGFueSwgbGVuIDogbnVtYmVyKSB7XHJcbiAgdmFyIHMgPSBcIlwiICthO1xyXG4gIHJldHVybiBcIjAwMDAwMDBcIi5zdWJzdHIoMCwgbGVuIC0gcy5sZW5ndGgpICsgcztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHBhZFNwYWNlKGEgOiBhbnksIGxlbiA6IG51bWJlcikge1xyXG4gIHZhciBzID0gXCJcIiArYTtcclxuICByZXR1cm4gXCIgICAgICAgICAgICAgICAgICAgXCIuc3Vic3RyKDAsIGxlbiAtIHMubGVuZ3RoKSArIHM7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwYWRTcGFjZVEoYSA6IGFueSwgbGVuIDogbnVtYmVyKSB7XHJcbiAgdmFyIHMgPSBcIlwiICthO1xyXG4gIHJldHVybiAnXCInICsgcyArICdcIicgKyBcIiAgICAgICAgICAgICAgICAgICBcIi5zdWJzdHIoMCwgbGVuIC0gcy5sZW5ndGgpO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFzRGF0ZShkYXRlSWR4IDogYW55KTogc3RyaW5nIHtcclxuICB2YXIgZCA9IHVuZGVmaW5lZCBhcyBMb2NhbERhdGU7XHJcbiAgaWYgKCBkYXRlSWR4IGluc3RhbmNlb2YgTG9jYWxEYXRlKSB7XHJcbiAgICBkID0gZGF0ZUlkeDtcclxuICB9IGVsc2Uge1xyXG4gICAgZCA9IGRhdGVJbmRleFRvRGF0ZShkYXRlSWR4KTtcclxuICB9XHJcbiAgcmV0dXJuICcnICsgZDtcclxuICAvL3JldHVybiBkLnllYXIoKSArIFwiLVwiICsgcGFkKGQubW9udGhWYWx1ZSgpLDIpICsgXCItXCIgKyBwYWQoZC5kYXlPZk1vbnRoKCksMik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBFT01PTlRIKGQgOiBMb2NhbERhdGUpIDogTG9jYWxEYXRlIHtcclxuICByZXR1cm4gY29weURhdGUoZCkucGx1c01vbnRocygxKS53aXRoRGF5T2ZNb250aCgxKS5taW51c0RheXMoMSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkYXlzSW5Nb250aChkIDogYW55KSB7XHJcbiAgdmFyIGR0ID11bmRlZmluZWQgYXMgTG9jYWxEYXRlO1xyXG4gIGlmKGQgaW5zdGFuY2VvZiBMb2NhbERhdGUgKSB7XHJcbiAgICBkdCA9IGQ7XHJcbiAgfSBlbHNlIHtcclxuICAgIGR0ID0gZGF0ZUluZGV4VG9EYXRlKGQgYXMgbnVtYmVyKTtcclxuICB9XHJcbiAgdmFyIGRlb20gPSBFT01PTlRIKGR0KTtcclxuICByZXR1cm4gZGF0ZVRvRGF5SW5kZXgoZGVvbSkgLSBkYXRlVG9EYXlJbmRleChjb3B5RGF0ZShkZW9tKS53aXRoRGF5T2ZNb250aCgxKSkgKyAxO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gd3JpdGVIZWFkZXIod3MpIHtcclxuICB3cy53cml0ZShcIkNBTE1PTlRISUM7Q0FMTU9OVEhJO0NBTE1PTlRIO0NBTE1PTlRIUztTVEFSVF9EQVRFX0lEWDtFTkRfREFURV9JRFg7SVNFT007SVNFT1E7SVNFT1k7REFZU0lOTU9OVEg7U1RBUlRfREFURTtFTkRfREFURTtcIilcclxuICB3cy53cml0ZShcIlVTRVI7TE9DQVRJT047SEM7SENfU09NO0hDX0VPTTtEQVlTV09SS0VEO0ZURTtGVEVfU09NO0ZURV9FT007RlRFV09SS0VEO1RFTlVSRTtURU5VUkVfU09NO1RFTlVSRV9FT007QUdFO0FHRV9TT007QUdFX0VPTTtYXFxuXCIpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB3cml0ZURheSh3cywgcHJldkRhdGVFbmQ6TG9jYWxEYXRlLCBkYXRlSWR4IDogTG9jYWxEYXRlKSB7XHJcbiAgdmFyIHN0YXJ0SWR4ID0gY29weURhdGUocHJldkRhdGVFbmQpLnBsdXNEYXlzKDEpO1xyXG4gIHZhciBkID0gZGF0ZUlkeDtcclxuICB2YXIgeSA9IGQueWVhcigpO1xyXG4gIHZhciBtID0gZC5tb250aFZhbHVlKCk7XHJcbiAgdmFyIGNtaSA9IHkqMTAwICsgbTtcclxuICB2YXIgY21pYyA9ICAoeS0yMDAwKSoxMiArIG07XHJcbiAgd3Mud3JpdGUoJycgKyBjbWljICsgXCI7XCIgKyBjbWkgKyBcIjtcIiArIGNtaSArIFwiO1wiICsgY21pKyBcIjtcIik7IC8vIENBTE1PTlRIIElDIEkgfiBTXHJcbiAgd3Mud3JpdGUoZGF0ZVRvRGF5SW5kZXgoc3RhcnRJZHgpKyBcIjtcIisgZGF0ZVRvRGF5SW5kZXgoZGF0ZUlkeCkgKyBcIjtcIik7XHJcbiAgd3Mud3JpdGUoaXNFT00oZCk/IFwiMS4wXCIgOiBcIjAuMFwiKS53cml0ZShcIjtcIik7XHJcbiAgd3Mud3JpdGUoaXNFT1EoZCk/IFwiMS4wXCIgOiBcIjAuMFwiKS53cml0ZShcIjtcIik7XHJcbiAgd3Mud3JpdGUoaXNFT1koZCk/IFwiMS4wXCIgOiBcIjAuMFwiKS53cml0ZShcIjtcIik7XHJcbiAgdmFyIGRpbSA9IGRheXNJbk1vbnRoKGQpO1xyXG4gIHdzLndyaXRlKGRpbSkud3JpdGUoXCI7XCIpO1xyXG4gIHdzLndyaXRlKGFzRGF0ZShzdGFydElkeCkpLndyaXRlKFwiO1wiKTtcclxuICB3cy53cml0ZShhc0RhdGUoZCkpLndyaXRlKFwiO1wiKTtcclxuICByZXR1cm4gZGltO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZGlmZlllYXJzKGRhdGVMb3c6IExvY2FsRGF0ZSwgZGF0ZUhpZ2g6IExvY2FsRGF0ZSkge1xyXG4gIHJldHVybiBkYXRlTG93LnVudGlsKGRhdGVIaWdoKS55ZWFycygpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZGlmZk1vbnRoKGRhdGVMb3cgOiBMb2NhbERhdGUsIGRhdGVIaWdoIDogTG9jYWxEYXRlKSB7XHJcbiAgdmFyIGEgPSBkYXRlTG93LnVudGlsKGRhdGVIaWdoKTtcclxuICByZXR1cm4gYS55ZWFycygpKjEyICsgYS5tb250aHMoKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHdyaXRlVEVOVVJFQUdFKHBlcnMgOlBlcnNvbikge1xyXG4gIHJldHVybiBwZXJzLmhpcmVkID4gMDtcclxufVxyXG4vL2NvbnNvbGUubG9nKGRpZmZZZWFycyhuZXcgRGF0ZSgyMDAxLDIsMSksIG5ldyBEYXRlKDIwMDIsMywxKSkpO1xyXG4vL2NvbnNvbGUubG9nKGRpZmZZZWFycyhuZXcgRGF0ZSgyMDAxLDIsMSksIG5ldyBEYXRlKDIwMDMsMSwzMSkpKTtcclxuLy9jb25zb2xlLmxvZyhkaWZmWWVhcnMobmV3IERhdGUoMjAwMSwyLDEpLCBuZXcgRGF0ZSgyMDAzLDIsMSkpKTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB3cml0ZVRlbnVyZSh3cywgbm93OiBMb2NhbERhdGUsIHBlcnM6IFBlcnNvbiwgZW9tKSB7XHJcbiAgaWYgKCAhd3JpdGVURU5VUkVBR0UocGVycykgKSB7XHJcbiAgICB3cy53cml0ZSgnMDswOzA7Jyk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIHZhciB0ZW51cmVOb3cgPSBkaWZmTW9udGgocGVycy5sYXN0SGlyZWQsbm93KTtcclxuICB3cy53cml0ZSh0ZW51cmVOb3cpLndyaXRlKCc7Jyk7XHJcbiAgaWYoIGlzRU9NKG5vdykpIHtcclxuICAgIHZhciBkc29tID0gZ2V0U09NKG5vdyk7XHJcbiAgICB2YXIgdGVudXJlU09NID0gZGlmZk1vbnRoKHBlcnMubGFzdEhpcmVkLGRzb20pO1xyXG4gICAgd3Mud3JpdGUodGVudXJlU09NKS53cml0ZSgnOycpXHJcbiAgICB3cy53cml0ZSh0ZW51cmVOb3cpLndyaXRlKCc7Jyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHdzLndyaXRlKCcwOzA7JylcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTT00oZGF0ZUlkeCA6IExvY2FsRGF0ZSkgIDogTG9jYWxEYXRlIHtcclxuICByZXR1cm4gZGF0ZUlkeC53aXRoRGF5T2ZNb250aCgxKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHdyaXRlQWdlKHdzLCBub3cgOiBMb2NhbERhdGUsIHBlcnMsIGVvbTogYm9vbGVhbikge1xyXG4gIGlmICggIXdyaXRlVEVOVVJFQUdFKHBlcnMpICkge1xyXG4gICAgd3Mud3JpdGUoJzA7MDswOycpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICB2YXIgYWdlTm93ID0gZGlmZlllYXJzKHBlcnMuZG9iLG5vdyk7XHJcbiAgd3Mud3JpdGUoYWdlTm93KS53cml0ZSgnOycpO1xyXG4gIGlmKCBpc0VPTShub3cpICkge1xyXG4gICAgdmFyIGRzb20gPSBnZXRTT00obm93KTtcclxuICAgIHZhciBhZ2VTT00gPSBkaWZmWWVhcnMocGVycy5kb2IsZHNvbSk7XHJcbiAgICB3cy53cml0ZShhZ2VTT00pLndyaXRlKCc7JylcclxuICAgIHdzLndyaXRlKGFnZU5vdykud3JpdGUoJzsnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgd3Mud3JpdGUoJzA7MDsnKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHdyaXRlVHJpcGVsKHdzLCB2c29tIDogYW55LCB2bm93OiBhbnksIGVvbSA6IGJvb2xlYW4pIHtcclxuICB3cy53cml0ZShwYWRTcGFjZSh2bm93LDMpKS53cml0ZSgnOycpO1xyXG4gIGlmKCBlb20gKSB7XHJcbiAgICB3cy53cml0ZShwYWRTcGFjZSh2c29tLDMpKS53cml0ZSgnOycpXHJcbiAgICB3cy53cml0ZShwYWRTcGFjZSh2bm93LDMpKS53cml0ZSgnOycpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB3cy53cml0ZSgnMC4wOzAuMDsnKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRvRGVjMShuIDogbnVtYmVyKSB7XHJcbiAgcmV0dXJuIChuIHx8IDApLnRvRml4ZWQoMSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtZW1vcml6ZVNPTShlb20gOiBib29sZWFuLHBlcnMgOiBQZXJzb24pIHtcclxuICBpZiAoZW9tKSB7XHJcbiAgICBwZXJzLmZ0ZVNPTSA9IHBlcnMuaGlyZWQgKiBwZXJzLmZ0ZTtcclxuICAgIHBlcnMuaGlyZWRTT00gPSBwZXJzLmhpcmVkO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHdyaXRlUmVjb3JkKHdzLCBkYXRlSWR4IDogTG9jYWxEYXRlLCBwZXJzIDogUGVyc29uLCBjb21tZW50OiBzdHJpbmcgKVxyXG57XHJcbiAgdmFyIHN0YXJ0SWR4ID0gY29weURhdGUocGVycy5wcmV2RGF0ZUVuZCkucGx1c0RheXMoMSk7XHJcbiAgdmFyIGVvbSA9IGlzRU9NKGRhdGVJZHgpO1xyXG4gIHdzLndyaXRlKHBhZFNwYWNlUShwZXJzLnVzZXIsNSkpLndyaXRlKCc7Jyk7XHJcbiAgd3Mud3JpdGUocGFkU3BhY2VRKHBlcnMubG9jYXRpb24sMjApKS53cml0ZSgnOycpO1xyXG4gIHdyaXRlVHJpcGVsKHdzLCBwZXJzLmhpcmVkU09NID8gXCIxLjBcIjogXCIwLjBcIiAscGVycy5oaXJlZCA/IFwiMS4wXCI6IFwiMC4wXCIsaXNFT00oZGF0ZUlkeCkpO1xyXG4gIHZhciBkYXlzSW5QZXJpb2QgPSBzdGFydElkeC51bnRpbChkYXRlSWR4KS5kYXlzKCkgKyAxO1xyXG4gIHdzLndyaXRlKHBhZFNwYWNlKHBlcnMuaGlyZWRQcmV2ICogZGF5c0luUGVyaW9kLDIpKS53cml0ZSgnOycpOyAvL0RBWVNXT1JLRURcclxuICB3cml0ZVRyaXBlbCh3cywgdG9EZWMxKHBlcnMuZnRlU09NKSx0b0RlYzEocGVycy5oaXJlZCAqIHBlcnMuZnRlKSxpc0VPTShkYXRlSWR4KSk7XHJcbiAgd3Mud3JpdGUocGFkU3BhY2UocGVycy5oaXJlZFByZXYgKiBwZXJzLmZ0ZVByZXYgKiBkYXlzSW5QZXJpb2QsNCkpLndyaXRlKCc7Jyk7IC8vIEZURVdPUktFRFxyXG4gIHdyaXRlVGVudXJlKHdzLCBkYXRlSWR4LCBwZXJzLCBlb20pO1xyXG4gIHdyaXRlQWdlKHdzLCBkYXRlSWR4LCBwZXJzLCBlb20pO1xyXG4gIHBlcnMuaGlyZWRQcmV2ID0gcGVycy5oaXJlZDtcclxuICBwZXJzLmZ0ZVByZXYgPSBwZXJzLmZ0ZTtcclxuICBtZW1vcml6ZVNPTShlb20scGVycyk7XHJcbiAgcGVycy5wcmV2RGF0ZUVuZCA9IGRhdGVJZHg7XHJcbiAgd3Mud3JpdGUoY29tbWVudCArIFwiXFxuXCIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB3cml0ZVN0YXRlTGluZSh3cyxkYXRlSWR4IDogTG9jYWxEYXRlLCBwZXJzLCBuZXh0SGlyZSwgbmV4dExvYywgbmV4dEZURSwgY29tbWVudDpzdHJpbmcpIHtcclxuICB3cml0ZURheSh3cywgcGVycy5wcmV2RGF0ZUVuZCwgZGF0ZUlkeCk7XHJcbiAgcGVycy5sb2NhdGlvbiA9IG5leHRMb2MgfHwgcGVycy5sb2NhdGlvbjtcclxuICBwZXJzLmZ0ZSA9IG5leHRGVEUgfHwgcGVycy5mdGU7XHJcbiAgcGVycy5sYXN0V3JpdHRlbiA9IGRhdGVJZHg7XHJcbiAgd3JpdGVSZWNvcmQod3MsIGRhdGVJZHgsIHBlcnMsIFwic3RcIiArIGNvbW1lbnQpO1xyXG4gIGlmKG5leHRIaXJlICE9IHBlcnMuaGlyZWQpIHtcclxuICAgIHdzLndyaXRlKFwiTkVWRVJcXG5cIilcclxuICB9XHJcbn1cclxuXHJcblxyXG5cclxuZnVuY3Rpb24gaXNVbmhpcmVkQ2hhbmdlKHBlcnM6IFBlcnNvbiwgbmV4dEhpcmUsIG5leHRMb2MsIG5leHRGVEUpIHtcclxuICByZXR1cm4gIChuZXh0SGlyZSAhPSBwZXJzLmhpcmVkKVxyXG4gICAgICAgfHwgKCBuZXh0TG9jICE9IHBlcnMubG9jYXRpb24gKVxyXG4gICAgICAgfHwgKCBuZXh0RlRFICE9IHBlcnMuZnRlICk7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBpc0FDaGFuZ2UocGVyczogUGVyc29uLCBuZXh0SGlyZSwgbmV4dExvYywgbmV4dEZURSkge1xyXG4gIHJldHVybiAgKG5leHRIaXJlICE9IHBlcnMuaGlyZWQpXHJcbiAgICAgICB8fCAocGVycy5oaXJlZCAmJiBuZXh0TG9jICE9IHBlcnMubG9jYXRpb24gKVxyXG4gICAgICAgfHwgKHBlcnMuaGlyZWQgJiYgbmV4dEZURSAhPSBwZXJzLmZ0ZSApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc0hJUkUoIHBlcnM6IFBlcnNvbiAsIG5leHRIaXJlICkge1xyXG4gIHJldHVybiBwZXJzLmhpcmVkID09IDAgJiYgbmV4dEhpcmUgPT0gMTtcclxufVxyXG5mdW5jdGlvbiBpc1RFUk0oIHBlcnM6IFBlcnNvbiAsIG5leHRIaXJlICkge1xyXG4gIHJldHVybiBwZXJzLmhpcmVkID09IDEgJiYgbmV4dEhpcmUgPT0gMDtcclxufVxyXG5cclxuLy8gdGhlcmUgaXMgYSBjaGFuZ2UgQGRhdGUgLCBuZXcgdmFsdWVzIGFyZSB0byB0aGUgcmlnaHQ7XHJcbmZ1bmN0aW9uIHdyaXRlQ2hhbmdlTGluZSh3cyxkYXRlSWR4IDogTG9jYWxEYXRlLCBwZXJzLCBuZXh0SGlyZSwgbmV4dExvYywgbmV4dEZURSwgY29tbWVudDpzdHJpbmcpIHtcclxuICB2YXIgaXNDaGFuZ2UgPSBpc0FDaGFuZ2UocGVycyxuZXh0SGlyZSxuZXh0TG9jLG5leHRGVEUpO1xyXG4gIGlmICggIWlzQ2hhbmdlICYmICFpc0VPTShkYXRlSWR4KSkge1xyXG4gICAgcGVycy5sb2NhdGlvbiA9IG5leHRMb2M7XHJcbiAgICBwZXJzLm5leHRGVEUgPSBuZXh0RlRFO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICB2YXIgaXN0ZXJtID0gaXNURVJNKHBlcnMsIG5leHRIaXJlKTtcclxuICBpZiAoIGlzdGVybSApIHtcclxuICAgIC8vIGNsb3NlIHByZXZpb3VzIHJlY29yZFxyXG4gICAgaWYgKGRhdGVJZHguZGF5T2ZNb250aCgpICE9IDEpIHsgLy8gdW5sZXNzIHdlIGFscmVhZHkgY2xvc2VkIGl0IGJ5IGEgbW9udGggcmVjb3JkXHJcbiAgICAgIHZhciBkbWluMSA9IGNvcHlEYXRlKGRhdGVJZHgpLm1pbnVzRGF5cygxKTtcclxuICAgICAgd3JpdGVEYXkod3MsIHBlcnMucHJldkRhdGVFbmQsIGRtaW4xKTtcclxuICAgICAgd3JpdGVSZWNvcmQod3MsIGRtaW4xLCBwZXJzLCBcInRlcm1jbG9zZS0xXCIgKyAgZGF0ZUlkeCArICcgJyArIGNvbW1lbnQpO1xyXG4gICAgfVxyXG4gICAgcGVycy5oaXJlZCA9IDA7XHJcbiAgICBwZXJzLmhpcmVkUHJldiA9IDA7XHJcbiAgICBwZXJzLmxhc3RUZXJtID0gZGF0ZUlkeDtcclxuICB9IGVsc2UgaWYgKCBpc0hJUkUocGVycyxuZXh0SGlyZSkpIHtcclxuICAgIHBlcnMubGFzdEhpcmVkID0gZGF0ZUlkeDtcclxuICAgIHBlcnMucHJldkRhdGVFbmQgPSBjb3B5RGF0ZShkYXRlSWR4KS5taW51c0RheXMoMSk7XHJcbiAgICAvLyBkbyBub3RoaW5nLCB3aWxsIGJlIGNhcHR1cmVkIG5leHRcclxuICB9IGVsc2Uge1xyXG4gICAgLy8gY2xvc2UgcHJldmlvdXMgcmVjb3JkXHJcbiAgICBpZiAoIGRhdGVJZHguZGF5T2ZNb250aCgpICE9IDEpIHtcclxuICAgICAgLy8gdW5sZXNzIHdlIGFscmVhZHkgY2xvc2VkIGl0IGJ5IGEgbW9udGggcmVjb3JkXHJcbiAgICAgIHZhciBkbWluMSA9IGNvcHlEYXRlKGRhdGVJZHgpLm1pbnVzRGF5cygxKTtcclxuICAgICAgd3JpdGVEYXkod3MsIHBlcnMucHJldkRhdGVFbmQsIGRtaW4xKTtcclxuICAgICAgd3JpdGVSZWNvcmQod3MsIGRtaW4xLCBwZXJzICwgXCJwZXJjbG9zZS0xIGZyb20gXCIgKyBkYXRlSWR4ICsgJyAnKyAgY29tbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHBlcnMuaGlyZWQgPSBuZXh0SGlyZTtcclxuICBwZXJzLmxvY2F0aW9uID0gbmV4dExvYztcclxuICBwZXJzLmZ0ZSA9IG5leHRGVEU7XHJcbiAgaWYgKGlzRU9NKGRhdGVJZHgpKSB7XHJcbiAgICAvLyBsYXRlciBzdXBwcmVzcyB1bmxlcyBsYXN0VGVybSB3aXRoaW4gcmFuZ2VcclxuICAgIHdyaXRlU3RhdGVMaW5lKHdzLGRhdGVJZHgscGVycywgcGVycy5oaXJlZCwgcGVycy5sb2NhdGlvbiwgcGVycy5mdGUsIFwiV0NMXCIpO1xyXG4gIH1cclxufVxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLyBwZXJjZW50YWdlc1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzSGlyZUNoYW5nZShwYXJzIDogR2VuUGFyYW1zKSA6IGJvb2xlYW4ge1xyXG4gIHJldHVybiBwYXJzLnJhbmRvbSgpIDwgcGFycy5MX0hJUkU7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5QZXJzb24od3MsIHAsIHBhcnM6IEdlblBhcmFtcykge1xyXG5cdHZhciBwZXJzID0ge1xyXG4gICAgdXNlciA6IHAsXHJcbiAgICBoaXJlZDogMCxcclxuICAgIGhpcmVkUHJldiA6IDAsXHJcbiAgICBmdGUgOiAxLFxyXG4gICAgZnRlUHJldiA6IDAsXHJcbiAgICBkb2IgOiBMb2NhbERhdGUub2YoMTk1MCtNYXRoLmZsb29yKHBhcnMucmFuZG9tKCkqNTUpLE1hdGguZmxvb3IocGFycy5yYW5kb20oKSoxMiksTWF0aC5mbG9vcihwYXJzLnJhbmRvbSgpKjMxKSksXHJcbiAgICBsb2NhdGlvbiA6IGdldExvY2F0aW9uKHBhcnMpLFxyXG4gICAgcHJldkRhdGVFbmQgOiBwYXJzLmZpcnN0RGF0ZSxcclxuICAgIGhpcmVkU09NIDogMCxcclxuICAgIGxhc3RIaXJlZCA6IHBhcnMuZmlyc3REYXRlLFxyXG4gICAgbGFzdFJlY29yZGVkIDogcGFycy5maXJzdERhdGUsXHJcbiAgICBmdGVTT00gOiAwXHJcbiAgfSBhcyBQZXJzb247XHJcbiAgdmFyIG5leHREYXRlID0gZ2V0TmV4dChwYXJzKSArIHBhcnMuZmlyc3REYXRlLnRvRXBvY2hEYXkoKTtcclxuICBmb3IodmFyIGkgPSBwYXJzLmZpcnN0RGF0ZS50b0Vwb2NoRGF5KCk7IGkgPD0gcGFycy5sYXN0RGF0ZS50b0Vwb2NoRGF5KCk7ICsraSkge1xyXG4gICAgdmFyIGQgPSBMb2NhbERhdGUub2ZFcG9jaERheShpKTtcclxuICAgIGlmICggaSA9PSBuZXh0RGF0ZSApIHtcclxuICAgICAgaWYoIGlzSGlyZUNoYW5nZShwYXJzKSkge1xyXG4gICAgICAgIHdyaXRlQ2hhbmdlTGluZSh3cyxkLHBlcnMsIHBlcnMuaGlyZWQgPyAwIDogMSwgbmV4dExvY2F0aW9uKHBhcnMscGVycyksIG5leHRGVEUocGFycyxwZXJzKSAgLCBcIkhDXCIpO1xyXG4gICAgICAgIG5leHREYXRlICs9IGdldE5leHQocGFycyk7XHJcbiAgICAgIH0gZWxzZSBpZiAoaXNFdmVudChwYXJzKSkge1xyXG4gICAgICAgIHZhciBubCA9IG5leHRMb2NhdGlvbihwYXJzLCBwZXJzKTtcclxuICAgICAgICAvLyBmb3JjZVxyXG4gICAgICAgIHZhciBuZiA9IG5leHRGVEUocGFycywgcGVycyk7XHJcbiAgICAgICAgd2hpbGUoICFpc1VuaGlyZWRDaGFuZ2UocGVycyxwZXJzLmhpcmVkLCBubCxuZikpIHtcclxuICAgICAgICAgIG5sID0gbmV4dExvY2F0aW9uKHBhcnMsIHBlcnMpO1xyXG4gICAgICAgICAgLy8gZm9yY2VcclxuICAgICAgICAgIG5mID0gbmV4dEZURShwYXJzLCBwZXJzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgd3JpdGVDaGFuZ2VMaW5lKHdzLCBkLCBwZXJzLCBwZXJzLmhpcmVkLCBubCwgbmYsIFwiTENcIiApO1xyXG4gICAgICAgIG5leHREYXRlICs9IGdldE5leHQocGFycyk7XHJcbiAgICAgIH0gZWxzZSBpZiAoaXNFT00oZCkpIHtcclxuICAgICAgICAgIHdyaXRlU3RhdGVMaW5lKHdzLCBkLCBwZXJzLCBwZXJzLmhpcmVkLCBwZXJzLmxvY2F0aW9uLCBwZXJzLmZ0ZSwgXCJFT01lXCIpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGlzRU9NKGQpKSB7XHJcbiAgICAgIC8vaWYoIHBlcnMuaGlyZWQgPiAwICkge1xyXG4gICAgICAgIHdyaXRlU3RhdGVMaW5lKHdzLCBkLCBwZXJzLCBwZXJzLmhpcmVkLCBwZXJzLmxvY2F0aW9uLCBwZXJzLmZ0ZSwgXCJFT01cIik7XHJcbiAgICAgIC8vfVxyXG4gICAgICAvLyBsZXNlIHtcclxuICAgICAgICBtZW1vcml6ZVNPTSh0cnVlLHBlcnMpO1xyXG4gICAgICAvL31cclxuICAgIH1cclxuXHR9O1xyXG59XHJcbiJdfQ==
